This is working version of the last homework, still lacking some parts unfortunetely.
